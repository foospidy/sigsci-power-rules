{
  "preLateRule": "",
  "initRule": "# NAME: CVE-2010-1870\n# DESCRIPTION: The OGNL extensive expression evaluation capability in XWork in Struts 2.0.0\n# through 2.1.8.1, as used in Atlassian Fisheye, Crucible, and possibly other\n# products, uses a permissive whitelist, which allows remote attackers to modify\n# server-side context objects and bypass the \"#\" protection mechanism in\n# ParameterInterceptors via the (1) #context, (2) #_memberAccess, (3) #root,\n# (4) #this, (5) #_typeResolver, (6) #_classResolver, (7) #_traceEvaluations,\n# (8) #_lastEvaluation, (9) #_keepLastEvaluation, and possibly other OGNL context\n# variables, a different vulnerability than CVE-2008-6504.\n# REFERENCES:\n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1870\n\n$regex := Array `^.*_memberAccess\\[.+$` `^.*_memberAccess\\.allowStaticMethodAccess.+$`\n\n$.Set \"_CVE20101870Matcher\" (NewRegexpMatcher $regex)",
  "postEarlyRule": "",
  "sampleResponse": "HTTP/1.1 200 OK\nServer: nginx\nDate: Fri, 21 Aug 2015 21:30:50 GMT\nContent-Type: text/html; charset=utf-8\nConnection: keep-alive\nContent-Length: 0\nx-xss-protection: 1; mode=block\nx-content-type-options: nosniff\npragma: no-cache\nx-frame-options: SAMEORIGIN\nStrict-Transport-Security: max-age=15552000; includeSubDomains\nX-Request-ID: 123456789",
  "postRule": "",
  "preRule": "$uri_match := $.URI | $.Config._CVE20101870Matcher.MatchOne\n\nif $uri_match\n $.AddSignal \"corp.CVE-2010-1870\" \"QUERYARGS\" (printf \"CVE-2010-1870; GET %s\" $.URI) $ruleid\n $.SetResponse $.Config.BlockHTTPCode\nend\n\nif (not $uri_match)\n range $.QueryArgs\n $key := (index . 0)\n $val := (index . 1)\n if $val | $.Config._CVE20101870Matcher.MatchOne\n $.AddSignal \"corp.CVE-2010-1870\" \"QUERYARGS\" (printf \"CVE-2010-1870; GET %s:%s\" $key $val) $ruleid\n $.SetResponse $.Config.BlockHTTPCode\n end\n end\nend\n\nrange $.PostArgs\n $key := (index . 0)\n $val := (index . 1)\n \n if $val | $.Config._CVE20101870Matcher.MatchOne\n $.AddSignal \"corp.CVE-2010-1870\" \"POSTARGS\" (printf \"CVE-2010-1870; POST %s:%s\" $key $val) $ruleid\n $.SetResponse $.Config.BlockHTTPCode\n end\nend",
  "preEarlyRule": "",
  "sampleRequest": "POST /MyStruts.action?a=('\\u0023_memberAccess[\\'allowStaticMethodAccess\\']')(meh)=true&(aaa)(('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003d\\u0023foo')(\\u0023foo\\u003dnew%20java.lang.Boolean(\"false\")))&(asdf)(('\\u0023rt.exit(1)')(\\u0023rt\\u003d@java.lang.Runtime@getRuntime()))=1 HTTP/1.1\nHost: sample.foo\nAccept-Encoding: gzip, deflate\nAccept-Language: en-us\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 10000\nCookie:\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/600.7.12 (KHTML, like Gecko) Version/8.0.7 Safari/600.7.12\nCache-Control: max-age=0\nX-Forwarded-For: 127.0.0.1\nX-Forwarded-Proto: https\n\npostkey1=value1&post2=value2",
  "shortName": "CVE-2010-1870",
  "postLateRule": "",
  "enabled": true
}
