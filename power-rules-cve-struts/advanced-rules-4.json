{
  "preLateRule": "",
  "initRule": "# NAME: CVE-2017-9791\n# DESCRIPTION: The Struts 1 plugin in Apache Struts 2.3.x might allow remote code execution\n# via a malicious field value passed in a raw message to the ActionMessage.\n# REFERENCES:\n# http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9791\n#",
  "postEarlyRule": "",
  "sampleResponse": "HTTP/1.1 200 OK\nServer: nginx\nDate: Fri, 21 Aug 2015 21:30:50 GMT\nContent-Type: text/html; charset=utf-8\nConnection: keep-alive\nContent-Length: 0\nx-xss-protection: 1; mode=block\nx-content-type-options: nosniff\npragma: no-cache\nx-frame-options: SAMEORIGIN\nStrict-Transport-Security: max-age=15552000; includeSubDomains\nX-Request-ID: 123456789",
  "postRule": "",
  "preRule": "$name_value := \"name\" | Lookup $.PostArgs\n\nif and ($name_value | StringContainsQ \"@ognl.OgnlContext\") \\\n ($.Path | StringEndsQ \"saveGangster.action\")\n\n $.AddSignal \"corp.CVE-2017-9791\" \"POSTARGS\" (printf \"%s\" $name_value) $ruleid\n $.SetResponse $.Config.BlockHTTPCode\nend",
  "preEarlyRule": "",
  "sampleRequest": "POST /2.3.15.1-showcase/integration/saveGangster.action HTTP/1.1\nHost: sample.foo\nAccept-Encoding: gzip, deflate\nAccept-Language: en-us\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 10000\nCookie:\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/600.7.12 (KHTML, like Gecko) Version/8.0.7 Safari/600.7.12\nCache-Control: max-age=0\nX-Forwarded-For: 127.0.0.1\nX-Forwarded-Proto: https\n\npostkey1=value1&name=%{(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(@java.lang.Runtime@getRuntime().exec('dir'))}",
  "shortName": "CVE-2017-9791",
  "postLateRule": "",
  "enabled": true
}
