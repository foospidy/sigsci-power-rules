{
  "preLateRule": "",
  "initRule": "# NAME: Bots\n# DESCRIPTION: Identify bot requests.\n# DEPENDENCY: Common/InvalidHTTP\n#\n#############\n# Init Rule #\n#############\n$bot := Array \\\n\"1job\" \\\n\"abot\" \\\n\"agentname\" \\\n\"apachebench\" \\\n\"aport\" \\\n\"applesyndication\" \\\n\"ask jeeves\" \\\n\"ask+jeeves\" \\\n\"atomz\" \\\n\"avantgo\" \\\n\"blitzbot\" \\\n\"bloglines\" \\\n\"bordermanager\" \\\n\"changedetection\" \\\n\"check_http\" \\\n\"checkurl\" \\\n\"chkd\" \\\n\"contype\" \\\n\"cosmos\" \\\n\"download ninja\" \\\n\"download+ninja\" \\\n\"dts agent\" \\\n\"dts+agent\" \\\n\"favorg\" \\\n\"flashget\" \\\n\"frontier\" \\\n\"getright\" \\\n\"golem\" \\\n\"gomezagent\" \\\n\"grabber\" \\\n\"hitlist\" \\\n\"ia_archive\" \\\n\"ibot\" \\\n\"ichiro\" \\\n\"ieautodiscovery\" \\\n\"indy library\" \\\n\"indy+library\" \\\n\"infolink\" \\\n\"internet ninja\" \\\n\"internet+ninja\" \\\n\"internetseer\" \\\n\"isilo\" \\\n\"jakarta\" \\\n\"jobo\" \\\n\"justview\" \\\n\"keynote\" \\\n\"kinja\" \\\n\"larbin\" \\\n\"libwww-perl\" \\\n\"linkbot\" \\\n\"linkchecker\" \\\n\"linklint\" \\\n\"linkscan\" \\\n\"linkwalker\" \\\n\"lisa\" \\\n\"lwp\" \\\n\"lydia\" \\\n\"magus bot\" \\\n\"magus+bot\" \\\n\"mediapartners-google\" \\\n\"mfc_tear_sample\" \\\n\"microsoft scheduled cache content download service\" \\\n\"microsoft url control\" \\\n\"microsoft+scheduled+cache+content+download+service\" \\\n\"microsoft+url+control\" \\\n\"miva\" \\\n\"mj12bot\" \\\n\"monitor\" \\\n\"monster\" \\\n\"mozilla/5.0 (compatible; msie 5.0)\" \\\n\"mozilla/5.0+(compatible;+msie+5.0)\" \\\n\"ms frontpage\" \\\n\"ms search\" \\\n\"ms+frontpage\" \\\n\"ms+search\" \\\n\"msnptc\" \\\n\"nbot\" \\\n\"newsnow\" \\\n\"nextgensearchbot\" \\\n\"nomad\" \\\n\"npbot\" \\\n\"nutch\" \\\n\"nutscrape\" \\\n\"omniexplorer\" \\\n\"patric\" \\\n\"pioneer\" \\\n\"pluck\" \\\n\"plumtree\" \\\n\"powermarks\" \\\n\"psbot\" \\\n\"rpt-http\" \\\n\"rssreader\" \\\n\"scooter\" \\\n\"seekbot\" \\\n\"sherlock\" \\\n\"shopwiki\" \\\n\"slurp\" \\\n\"stackrambler\" \\\n\"sucker\" \\\n\"templeton\" \\\n\"/teoma\" \\\n\"thunderstone\" \\\n\"t-h-u-n-d-e-r-s-t-o-n-e\" \\\n\"topix\" \\\n\"ukonline\" \\\n\"ultraseek\" \\\n\"urchin\" \\\n\"vagabondo\" \\\n\"voyager\" \\\n\"web downloader\" \\\n\"web+downloader\" \\\n\"webauto\" \\\n\"webcapture\" \\\n\"webcheck\" \\\n\"webcopier\" \\\n\"webdup\" \\\n\"webtool\" \\\n\"wfarc\" \\\n\"wget\" \\\n\"whatsup\" \\\n\"xenu\" \\\n\"yacy\" \\\n\"zealbot\" \\\n\"zeus\" \\\n\"ez publish link validator\" \\\n\"ez+publish+link+validator\" \\\n\"terrawizbot\" \\\n\"goldfire\" \\\n\"sitevigil\" \\\n\"iopus\" \\\n\"microsoft bits\" \\\n\"microsoft+bits\" \\\n\"heritrix\" \\\n\"yahoofeedseeker\" \\\n\"internal zero-knowledge agent\" \\\n\"internal+zero-knowledge+agent\" \\\n\"surveybot/\" \\\n\"liferea\" \\\n\"yahooseeker\" \\\n\"findlinks\" \\\n\"oodlebot\" \\\n\"adsbot-google\" \\\n\"innovantagebot\" \\\n\"khte\" \\\n\"ktxn\" \\\n\"advanced email extractor\" \\\n\"advanced+email+extractor\" \\\n\"moreoverbot\" \\\n\"webbot\" \\\n`search_comments\\at\\sensis\\dot\\com\\dot\\au` \\\n\"panscient.com\" \\\n\"snoopy\" \\\n\"bot/1.0\" \\\n\"universalsearch\" \\\n\"maxamine\" \\\n\"argus\" \\\n\"google wireless transcoder\" \\\n\"google+wireless+transcoder\" \\\n\"clickajob\" \\\n\"jobrapido\" \\\n\"python-urllib\" \\\n\"isearch\" \\\n\"http://bot.ims.ca\" \\\n\"system center operations manager\" \\\n\"system+center+operations+manager\" \\\n\"joedog\" \\\n\"websitepulse\" \\\n\"bitvouseragent\" \\\n\"mozilla/4.0 (compatible; msie 6.0; windows nt 5.1;1813)\" \\\n\"mozilla/4.0+(compatible;+msie+6.0;+windows+nt+5.1;1813)\" \\\n\"paros\" \\\n\"watchmouse\" \\\n\"proximic\" \\\n\"scoutjet\" \\\n\"twiceler\" \\\n\"pingdom\" \\\n\"europarchive\" \\\n\"search-engine-studio\" \\\n\"webmetrics\" \\\n\"holmes\" \\\n\"alertsite\" \\\n\"yahoo pipes\" \\\n\"yahoo+pipes\" \\\n\"simplepie\" \\\n\"drupal\" \\\n\"htmlparser\" \\\n\"watchfire webxm\" \\\n\"watchfire+webxm\" \\\n\"snappreviewbot\" \\\n\"snapbot\" \\\n\"daumoa\" \\\n\"nielsen adr\" \\\n\"nielsen+adr\" \\\n\"evrinid\" \\\n\"fdm 3.x\" \\\n\"fdm+3.x\" \\\n\"isense bot\" \\\n\"isense+bot\" \\\n\"trovit\" \\\n\"riverglassscanner\" \\\n\"wepbot\" \\\n\"mlbot\" \\\n\"siteimprove\" \\\n\"archive.org\" \\\n\"vocusbot\" \\\n\"fairshare\" \\\n\"blp_bbot\" \\\n\"w3c_validator\" \\\n\"(simulated_by_webserver_stress_tool)\" \\\n\"wapt\" \\\n\"updatepatrol\" \\\n\"sitecon\" \\\n\"www-mechanize\" \\\n\"google web preview\" \\\n\"google+web+preview\" \\\n\"adgbot\" \\\n\"httpunit\" \\\n\"curious george\" \\\n\"curious+george\" \\\n\"postrank\" \\\n\"httpcomponents\" \\\n\"twisted pagegetter\" \\\n\"twisted+pagegetter\" \\\n\"servers alive url check\" \\\n\"servers+alive+url+check\" \\\n\"appengine-google\" \\\n\"yioopbot\" \\\n\"flamingo_searchengine\" \\\n\"atomic_email_hunter\" \\\n\"feedburner\" \\\n\"talktalk\" \\\n\"facebookexternalhit\" \\\n\"adbeat\" \\\n\"sjn\" \\\n\"outbrain\" \\\n\"tweetmemebot\" \\\n\"wasalive\" \\\n\"wikiwix-bot\" \\\n\"ezooms\" \\\n\"hiscan\" \\\n\"d24y-aegis\" \\\n\"google-hoteladsverifier\" \\\n\"fupbot\" \\\n\"moatbot\" \\\n\"vmcbot\" \\\n\"wusage/\" \\\n\"wikiofeedbot\" \\\n\"jobblebot\" \\\n\"companydatatree\" \\\n\"cookiereports\" \\\n\"wbsearchbot\" \\\n\"bingpreview\" \\\n\"scan\" \\\n\"smokeping\" \\\n\"flamingosearch\" \\\n\"reconnoiter\" \\\n\"ec2linkfinder\" \\\n\"citeseerxbot\" \\\n\"funnelback\" \\\n\"feed43\" \\\n\"auditbot\" \\\n\"genieo\" \\\n\"nerdbynature\" \\\n\"python-httplib\" \\\n\"cutbot\" \\\n\"server density external llama\" \\\n\"server+density+external+llama\" \\\n\"mna digital circonus check\" \\\n\"mna+digital+circonus+check\" \\\n\"aware\" \\\n\"appneta sequencer\" \\\n\"appneta+sequencer\" \\\n\"scanalert\" \\\n\"catchpoint\" \\\n\"discoverybot\" \\\n\"jooblebot\" \\\n\"bitlybot\" \\\n\"adr)\" \\\n\"yottaamonitor\" \\\n\"adometrybot\" \\\n\"tsmbot\" \\\n\"orangebot-mobile\" \\\n\"phantomjs\" \\\n\"scc internet services - url check\" \\\n\"scc+internet+services+-+url+check\" \\\n\"apache-httpclient/4.1.1 (java 1.5)\" \\\n\"apache-httpclient/4.1.1+(java+1.5)\" \\\n\"tagscanner\" \\\n\"loadimpactpageanalyzer\" \\\n\"cfschedule\" \\\n\"searchme.com/support/\" \\\n\"b2w\" \\\n\"coast\" \\\n\"combine\" \\\n\"crawl\" \\\n\"crescent\" \\\n\"dialer\" \\\n\"echo\" \\\n\"fetch\" \\\n\"grub\" \\\n\"harvest\" \\\n\"httrack\" \\\n\"newsapp\" \\\n\"ng/2.0\" \\\n\"obot\" \\\n\"pita\" \\\n\"sohu\" \\\n\"spider\" \\\n\"spike\" \\\n\"stuff\" \\\n\"teleport\" \\\n\"webtrends\" \\\n\"worm\" \\\n\"yandex\" \\\n\"freedom\" \\\n\"192.comagent\" \\\n\"247sitewatch\" \\\n\"amznkassocbot\" \\\n\"aol_cap\" \\\n\"albertbot\" \\\n\"apache-httpclient/4.0 (java 1.5)\" \\\n\"apache-httpclient/4.0+(java+1.5)\" \\\n\"attributor\" \\\n\"automapit\" \\\n\"bimbo\" \\\n\"busiversebot\" \\\n\"c4bot\" \\\n\"ce-preload\" \\\n\"cogisumbot\" \\\n\"contentsmartz\" \\\n\"d1garabicengine\" \\\n\"dotbot\" \\\n\"emailsmartz\" \\\n\"enfish tracker\" \\\n\"enfish+tracker\" \\\n\"feedfetcher\" \\\n\"feedforall\" \\\n\"firehunter\" \\\n\"forex trading network organization\" \\\n\"forex+trading+network+organization\" \\\n\"globrix\" \\\n\"http-webtest\" \\\n\"hobbit\" \\\n\"hoopla\" \\\n\"jdxrobot\" \\\n\"jumpbot\" \\\n\"kalooga\" \\\n\"linguee bot\" \\\n\"linguee+bot\" \\\n\"litefinder\" \\\n\"lucidmedia clicksense\" \\\n\"lucidmedia+clicksense\" \\\n\"msnrv\" \\\n\"msrbot\" \\\n\"macreport\" \\\n\"n-central\" \\\n\"nasa search\" \\\n\"ntte poller\" \\\n\"ntte+poller\" \\\n\"naverbot\" \\\n\"noteworthybot\" \\\n\"pagebull\" \\\n\"powerset\" \\\n\"pricerunner\" \\\n\"pureload\" \\\n\"purebot\" \\\n\"quintura-crw\" \\\n\"rankurbot\" \\\n\"swsbot\" \\\n\"scraperwiki\" \\\n\"shablastbot\" \\\n\"sightupbot\" \\\n\"sitealarm\" \\\n\"skreemrbot\" \\\n\"sphere scout\" \\\n\"sphere+scout\" \\\n\"swish-e\" \\\n\"tasapspider\" \\\n\"truveo\" \\\n\"twingly\" \\\n\"webgrab\" \\\n\"webnews arianna\" \\\n\"webnews+arianna\" \\\n\"yahoo-richabstracts\" \\\n\"yanga\" \\\n\"abilon\" \\\n\"accoona-ai-agent\" \\\n\"aipbot\" \\\n\"aladdino\" \\\n\"appie\" \\\n\"arachnia\" \\\n\"aranha\" \\\n\"art-online.com\" \\\n\"asterias\" \\\n\"avsearch\" \\\n\"backweb\" \\\n\"becomebot\" \\\n\"bigbrother\" \\\n\"bumblebee\" \\\n\"business-semantics\" \\\n\"c r a w l e r\" \\\n\"c+r+a+w+l+e+r\" \\\n\"change detection\" \\\n\"change+detection\" \\\n\"cometsearch\" \\\n\"convera\" \\\n\"copernicenterprisesearch\" \\\n\"copyrightcheck\" \\\n\"crucial inforation miner\" \\\n\"crucial+inforation+miner\" \\\n\"diphonet\" \\\n\"dtaagent\" \\\n\"enews creator\" \\\n\"enews+creator\" \\\n\"earthcom.info\" \\\n\"emailsiphon\" \\\n\"feedonfeeds\" \\\n\"filehound\" \\\n\"freefind\" \\\n\"geniebot\" \\\n\"go!zilla\" \\\n\"gulliver\" \\\n\"hapax\" \\\n\"hit list\" \\\n\"hit+list\" \\\n\"htdig\" \\\n\"ideare\" \\\n\"iisbot\" \\\n\"iltrovatore-setaccio\" \\\n\"infoseek\" \\\n\"inktomi search\" \\\n\"inktomi+search\" \\\n\"inverse ip insight\" \\\n\"inverse+ip+insight\" \\\n\"ipsentry\" \\\n\"irc search\" \\\n\"irc+search\" \\\n\"irlbot\" \\\n\"janrain-lobster\" \\\n\"jetbot\" \\\n\"keepalive\" \\\n\"kilroy\" \\\n\"kummhttp\" \\\n\"lachesis\" \\\n\"lightspeed systems\" \\\n\"lightspeed+systems\" \\\n\"linksweeper\" \\\n\"locust\" \\\n\"lotusdiscovery\" \\\n\"mac finder\" \\\n\"mac+finder\" \\\n\"mackster\" \\\n\"magenta\" \\\n\"markwatch\" \\\n\"mazingo\" \\\n\"mazzilla\" \\\n\"mercator\" \\\n\"microsoft internet explorer/4.40.426 (windows 95)\" \\\n\"microsoft+internet+explorer/4.40.426+(windows+95)\" \\\n\"minuteman\" \\\n\"mirago\" \\\n\"missigua\" \\\n\"mobipocket webcompanion\" \\\n\"mobipocket+webcompanion\" \\\n\"moget\" \\\n\"mothra/126-paladium\" \\\n\"mozilla 2.0 (compatible; msie 3.02; update a; windows nt)\" \\\n\"mozilla+2.0+(compatible;+msie+3.02;+update+a;+windows+nt)\" \\\n\"nalanda\" \\\n\"nessus\" \\\n\"netmechanic\" \\\n\"nettraffic sensor\" \\\n\"nettraffic+sensor\" \\\n\"new/0.1libwww\" \\\n\"news reader\" \\\n\"news search\" \\\n\"news+reader\" \\\n\"news+search\" \\\n\"newsbot\" \\\n\"newslookup\" \\\n\"newsmachine\" \\\n\"newssearch\" \\\n\"newstin\" \\\n\"ocelli\" \\\n\"onkosh\" \\\n\"openfind\" \\\n\"oracle ultra search\" \\\n\"oracle+ultra+search\" \\\n\"perman surfer\" \\\n\"perman+surfer\" \\\n\"polybot\" \\\n\"pompos\" \\\n\"port huron labs\" \\\n\"port+huron+labs\" \\\n\"proxysg\" \\\n\"psycheclone\" \\\n\"pulpfiction\" \\\n\"quepasacreep\" \\\n\"rational sitecheck\" \\\n\"rational+sitecheck\" \\\n\"realnamesbot\" \\\n\"richmetrics.com/bot\" \\\n\"robtexbot\" \\\n\"rss client\" \\\n\"rss+client\" \\\n\"rssmaker-ng\" \\\n\"rufusbot\" \\\n\"sawaalrobo\" \\\n\"schmozilla\" \\\n\"scirus\" \\\n\"scoutabout\" \\\n\"search.ch\" \\\n\"seeker.lookseek.com\" \\\n\"servers alive\" \\\n\"servers+alive\" \\\n\"sitescooper\" \\\n\"slysearch\" \\\n\"snooper\" \\\n\"spinne\" \\\n\"spyder\" \\\n\"squid cache\" \\\n\"squid+cache\" \\\n\"sundoh search\" \\\n\"sundoh+search\" \\\n\"szukacz\" \\\n\"urlcheck\" \\\n\"versus\" \\\n\"vivisimo\" \\\n\"webclipping.com\" \\\n\"webextractor\" \\\n\"webinator\" \\\n\"website extractor\" \\\n\"website+extractor\" \\\n\"webvac\" \\\n\"webzip\" \\\n\"whistleblower\" \\\n\"whizbang\" \\\n\"zibber\" \\\n\"zipppbot\" \\\n\"zyborg\" \\\n\"uptime\"\n\n$bot_script := Array \\\n\"lwp\" \\\n\"python-httplib2\" \\\n\"python-requests\" \\\n\"python-urllib\" \\\n\"libwww-perl/\" \\\n\"ruby\" \\\n\"java/\" \\\n\"apache-httpclient/\" \\\n\"winhttp\" \\\n\"go-http-client/\" \\\n\"webdav client\" \\\n\"wordpress/\" \\\n\"curl\" \\\n\"wget\" \\\n\"microsoft office excel 2013\" \\\n\"struts-pwn (https://github.com/mazen160/struts-pwn)\"\n\n$bot_crawler_seo := Array \\\n\"screaming frog seo spider/\"\n\n$bot_crawler_scraper := Array \\\n\"scrapy\" \\\n\"advanced email extractor\"\n\n$bot_crawler_sitemapper := Array \\\n\"visualsitemapper\" \\\n\"ahrefsbot\"\n\n$bot_crawler_searchengine := Array \\\n\"twitterbot/\" \\\n\"bingbot/\" \\\n\"googlebot/\" \\\n\"applebot/\" \\\n\"yahoo! slurp;\" \\\n\"yandexBot/\" \\\n\"dataprovider/\" \\\n\"piplbot\" \\\n\"baiduspider\" \\\n\"Google-HTTP-Java-Client/\"\n\n$.Set \"BrowserUaMinLength\" 50\n$.Set \"BotMatcher\" (NewAhoCorasickMatcher $bot)\n$.Set \"BotScriptMatcher\" (NewAhoCorasickMatcher $bot_script)\n$.Set \"BotCrawlerSeoMatcher\" (NewAhoCorasickMatcher $bot_crawler_seo)\n$.Set \"BotCrawlerScraperMatcher\" (NewAhoCorasickMatcher $bot_crawler_scraper)\n$.Set \"BotCrawlerSitemapperMatcher\" (NewAhoCorasickMatcher $bot_crawler_sitemapper)\n$.Set \"BotCrawlerSearchengineMatcher\" (NewAhoCorasickMatcher $bot_crawler_searchengine)",
  "postEarlyRule": "",
  "sampleResponse": "HTTP/1.1 200 OK\nServer: nginx\nDate: Fri, 21 Aug 2015 21:30:50 GMT\nContent-Type: text/html; charset=utf-8\nConnection: keep-alive\nContent-Length: 0\nx-xss-protection: 1; mode=block\nx-content-type-options: nosniff\npragma: no-cache\nx-frame-options: SAMEORIGIN\nStrict-Transport-Security: max-age=15552000; includeSubDomains\nX-Request-ID: 123456789",
  "postRule": "",
  "preRule": "$botmap := NewMapAny\n$botmap.Set \"bot\" \"\"\n$botmap.Set \"reason\" \"\"\n\n$ua_len := $.UserAgent | len\n\nif $ua_len | LessEqual $.Config.BrowserUaMinLength\n $botmap.Set \"bot\" (printf \"%s%s\" $botmap.bot \"\")\n $botmap.Set \"reason\" (printf \"%s; UA Len: %d\" $botmap.reason $ua_len)\nend\n\nif lower $.UserAgent | $.Config.BotMatcher.MatchOne\n $botmap.Set \"bot\" (printf \"%s%s\" $botmap.bot \"\")\n $botmap.Set \"reason\" (printf \"%s; Bot-UA: %s\" $botmap.reason $.UserAgent)\nend\n\nif lower $.UserAgent | $.Config.BotScriptMatcher.MatchOne\n $botmap.Set \"bot\" (printf \"%s%s\" $botmap.bot \"\")\n $botmap.Set \"reason\" (printf \"%s; Script: %s\" $botmap.reason $.UserAgent)\nend\n\nif lower $.UserAgent | $.Config.BotCrawlerSeoMatcher.MatchOne\n $botmap.Set \"bot\" (printf \"%s%s\" $botmap.bot \"\")\n $botmap.Set \"reason\" (printf \"%s; SEO: %s\" $botmap.reason $.UserAgent)\nend\n\nif lower $.UserAgent | $.Config.BotCrawlerScraperMatcher.MatchOne\n $botmap.Set \"bot\" (printf \"%s%s\" $botmap.bot \"\")\n $botmap.Set \"reason\" (printf \"%s; Scraper: %s\" $botmap.reason $.UserAgent)\nend\n\nif lower $.UserAgent | $.Config.BotCrawlerSitemapperMatcher.MatchOne\n $botmap.Set \"bot\" (printf \"%s%s\" $botmap.bot \"\")\n $botmap.Set \"reason\" (printf \"%s; Mapper: %s\" $botmap.reason $.UserAgent)\nend\n\nif lower $.UserAgent | $.Config.BotCrawlerSearchengineMatcher.MatchOne\n $botmap.Set \"bot\" (printf \"%s%s\" $botmap.bot \"\")\n $botmap.Set \"reason\" (printf \"%s; Search: %s\" $botmap.reason $.UserAgent)\nend\n\nif $.TagList | ContainsAny (Array \"site.http-accept\")\n $botmap.Set \"bot\" (printf \"%s%s\" $botmap.bot \"\")\n $botmap.Set \"reason\" (printf \"%s; Missing Accept\" $botmap.reason)\nend\n\nif $botmap.bot | len | Greater 0\n $.AddSignal \"site.bot\" \"REQUEST\" (printf \"%s%s\" $botmap.bot $botmap.reason) $ruleid\nend",
  "preEarlyRule": "",
  "sampleRequest": "POST /foobar?key1=value1 HTTP/1.1\nHost: sample.foo\nAccept-Encoding: gzip, deflate\nAccept-Language: en-us\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 10000\nCookie:\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/600.7.12 (KHTML, like Gecko) Version/8.0.7 Safari/600.7.12\nCache-Control: max-age=0\nX-Forwarded-For: 127.0.0.1\nX-Forwarded-Proto: https\n\npostkey1=value1&post2=value2",
  "shortName": "Bots",
  "postLateRule": "",
  "enabled": true
}
